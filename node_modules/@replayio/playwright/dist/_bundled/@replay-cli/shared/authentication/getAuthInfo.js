'use strict';

var cache = require('../cache.js');
var cachePath = require('../graphql/cachePath.js');
var fetchAuthInfoFromGraphQL = require('../graphql/fetchAuthInfoFromGraphQL.js');
var updateCachedAuthInfo = require('../graphql/updateCachedAuthInfo.js');

async function getAuthInfo(accessToken) {
  const cached = cache.readFromCache(cachePath.cachePath) ?? {};
  let authInfo = cached[accessToken];
  if (!authInfo) {
    authInfo = await fetchAuthInfoFromGraphQL.fetchAuthInfoFromGraphQL(accessToken);
    updateCachedAuthInfo.updateCachedAuthInfo(accessToken, authInfo);
  }
  return authInfo;
}

exports.getAuthInfo = getAuthInfo;
