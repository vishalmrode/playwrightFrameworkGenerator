'use strict';

var fsExtra = require('fs-extra');
var logger = require('../logger.js');
var config = require('./config.js');

function updateRecordingLog(recording, partialEntry) {
  logger.logDebug(`Updating recording log ${config.recordingLogPath}`);
  logger.logDebug(`Appending entry for recording ${recording.id}`, { partialEntry, recording });
  const entry = {
    ...partialEntry,
    id: recording.id,
    recordingId: recording.id,
    timestamp: Date.now()
  };
  fsExtra.appendFileSync(config.recordingLogPath, `
${JSON.stringify(entry)}
`, {
    encoding: "utf8"
  });
}

exports.updateRecordingLog = updateRecordingLog;
