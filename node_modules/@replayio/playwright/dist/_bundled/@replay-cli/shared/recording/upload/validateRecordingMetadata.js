'use strict';

var sanitizeMetadata = require('../metadata/sanitizeMetadata.js');

async function validateRecordingMetadata(recording) {
  const {
    duration,
    id,
    metadata: { host, uri, ...rest }
  } = recording;
  const metadata = await sanitizeMetadata.sanitizeMetadata(rest);
  return {
    metadata,
    recordingData: {
      duration: duration ?? 0,
      id,
      url: uri ?? "",
      title: host ?? "",
      // This info is only set for Gecko recordings
      // github.com/replayio/replay-cli/commit/6d9b8b95a3a55eb9a0aa0721199242cfaf319356#r140608348
      operations: {
        scriptDomains: []
      },
      lastScreenData: "",
      lastScreenMimeType: ""
    }
  };
}

exports.validateRecordingMetadata = validateRecordingMetadata;
