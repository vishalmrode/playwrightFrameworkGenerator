'use strict';

var cache = require('./cache.js');
var getObservabilityCachePath = require('./getObservabilityCachePath.js');
var crypto = require('crypto');

const cachePath = getObservabilityCachePath.getObservabilityCachePath("device.json");
function getDeviceId() {
  const cached = cache.readFromCache(cachePath) ?? {};
  let deviceId = cached["id"];
  if (!deviceId) {
    deviceId = crypto.randomUUID();
    cached["id"] = deviceId;
    cache.writeToCache(cachePath, cached);
  }
  return deviceId;
}

exports.getDeviceId = getDeviceId;
